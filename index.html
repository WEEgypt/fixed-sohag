<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width,initial-scale=0.75,maximum-scale=1,user-scalable=no" />
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
        <title>Fixed Requests "Sohag"</title>
        <link rel="icon" href="icon.png" />
        <link rel="apple-touch-icon" href="icon.png" />
        <link rel="stylesheet" href="style.css" />
    </head>
    <body onload="GetDate()">
        <div class="mainDiv">
            <form method="post" name="FixedRequest" id="FixedRequest">
                <h2>Fixed Requests "Sohag"</h2>
                <table>
                    <tr>
                        <td><label>Request Date</label></td>
                        <td>
                            <select id="day">
                                <option value="" selected disabled hidden>Day</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                                <option value="13">13</option>
                                <option value="14">14</option>
                                <option value="15">15</option>
                                <option value="16">16</option>
                                <option value="17">17</option>
                                <option value="18">18</option>
                                <option value="19">19</option>
                                <option value="20">20</option>
                                <option value="21">21</option>
                                <option value="22">22</option>
                                <option value="23">23</option>
                                <option value="24">24</option>
                                <option value="25">25</option>
                                <option value="26">26</option>
                                <option value="27">27</option>
                                <option value="28">28</option>
                                <option value="29">29</option>
                                <option value="30">30</option>
                                <option value="31">31</option>
                            </select>
                        </td>
                        <td>
                            <select id="month" onchange="DaysFix()">
                                <option value="" selected disabled hidden>Month</option>
                                <option value="1">January</option>
                                <option value="2">February</option>
                                <option value="3">March</option>
                                <option value="4">April</option>
                                <option value="5">May</option>
                                <option value="6">June</option>
                                <option value="7">July</option>
                                <option value="8">August</option>
                                <option value="9">September</option>
                                <option value="10">October</option>
                                <option value="11">November</option>
                                <option value="12">December</option>
                            </select>
                        </td>
                        <td>
                            <select id="year" onchange="DaysFix()">
                                <option value="" selected disabled hidden>Year</option>
                                <option value="2023">2023</option>
                                <option value="2024">2024</option>
                                <option value="2025">2025</option>
                                <option value="2026">2026</option>
                                <option value="2027">2027</option>
                                <option value="2028">2028</option>
                                <option value="2029">2029</option>
                                <option value="2030">2030</option>
                            </select>
                        </td>
                    </tr>
                    <input type="text" name="Request Date" id="RequestDate" hidden />
                    <tr>
                        <td><label>Store Name</label></td>
                        <td colspan="3">
                            <select name="Store" id="store">
                                <option value="" selected disabled hidden>Store Name</option>
                                <option value="شرق النيل">شرق النيل</option>
                                <option value="شارع 15">شارع 15</option>
                                <option value="نادى التجديف">نادى التجديف</option>
                                <option value="بيت الرحمه">بيت الرحمه</option>
                                <option value="الشهيد">الشهيد</option>
                                <option value="المخبز الآلي">المخبز الآلي</option>
                                <option value="مجمع المحاكم">مجمع المحاكم</option>
                                <option value="اخميم">اخميم</option>
                                <option value="المنشاه">المنشاه</option>
                                <option value="دار السلام">دار السلام</option>
                                <option value="جرجا - المصريه جروب">جرجا - المصريه جروب</option>
                                <option value="جرجا - فيوتشر">جرجا - فيوتشر</option>
                                <option value="البلينا - تليكوم">البلينا - تليكوم</option>
                                <option value="البلينا - فيوتشر">البلينا - فيوتشر</option>
                                <option value="المراغه - المصريه جروب">المراغه - المصريه جروب</option>
                                <option value="المراغه - فيوتشر">المراغه - فيوتشر</option>
                                <option value="طما - فيوتشر">طما - فيوتشر</option>
                                <option value="طما - كافريج">طما - كافريج</option>
                                <option value="طهطا - المصريه جروب">طهطا - المصريه جروب</option>
                                <option value="طهطا - فيوتشر">طهطا - فيوتشر</option>
                                <option value="جهينه">جهينه</option>
                                <option value="برديس">برديس</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><label>Agent Name</label></td>
                        <td colspan="3"><input type="text" name="Agent Name" id="AgentName" /></td>
                    </tr>
                    <tr>
                        <td><label>Customer Name</label></td>
                        <td colspan="3"><input type="text" name="Customer Name" id="CSTName" /></td>
                    </tr>
                    <tr>
                        <td><label>Address</label></td>
                        <td colspan="3"><input type="text" name="Address" id="Address" /></td>
                    </tr>
                    <tr>
                        <td><label>Customer ID</label></td>
                        <td colspan="3"><input type="number" name="Customer ID" id="CSTId" /></td>
                    </tr>
                    <tr>
                        <td><label>Contact Number</label></td>
                        <td colspan="3"><input type="number" name="Contact Number" id="ContactNumber" /></td>
                    </tr>
                    <tr>
                        <td><label>Central</label></td>
                        <td colspan="3"><input type="text" name="Central" id="Central" /></td>
                    </tr>
                    <tr>
                        <td><label>Serial</label></td>
                        <td colspan="3"><input type="number" name="Serial" id="Serial" /></td>
                    </tr>
                    <tr>
                        <td><label>Status</label></td>
                        <td colspan="3">
                            <select id="status" name="Availabilty">
                                <option value="" selected disabled hidden>Availabilty</option>
                                <option value="Available">Available</option>
                                <option value="Not Available">Not Available</option>
                                <option value="تم التنفيذ في الفرع">تم التنفيذ في الفرع</option>
                                <option value="تم التنفيذ في السنترال">تم التنفيذ في السنترال</option>
                            </select>
                        </td>
                    </tr>
                </table>
                <br />
                <input style="display: none;" id="submit" type="submit" value="Submit" />
                <button type="button" id="checkandsubmit" onclick="checkInput()">Submit</button>
                <button type="button" id="another" onclick="Another()" hidden>Another one</button>
                <br />
            </form>
        </div>
        <script>
            function GetDate() {
                document.getElementById("month").value = new Date().getMonth() + 1;
                document.getElementById("year").value = new Date().getFullYear();
                DaysFix();
            }
            function DaysFix() {
                var daysinmonth = new Date(document.getElementById("year").value, document.getElementById("month").value, 0).getDate();
                if (daysinmonth < 31 && document.getElementById("day").value == 31) {
                    document.getElementById("day").selectedIndex = "30";
                }
                if (daysinmonth < 30 && document.getElementById("day").value == 30) {
                    document.getElementById("day").selectedIndex = "29";
                }
                if (daysinmonth < 29 && document.getElementById("day").value == 29) {
                    document.getElementById("day").selectedIndex = "28";
                }
                if (daysinmonth < 31 && document.getElementById("day").length == "32") {
                    const list = document.getElementById("day");
                    list.removeChild(list.lastElementChild);
                }
                if (daysinmonth < 30 && document.getElementById("day").length == "31") {
                    const list = document.getElementById("day");
                    list.removeChild(list.lastElementChild);
                }
                if (daysinmonth < 29 && document.getElementById("day").length == "30") {
                    const list = document.getElementById("day");
                    list.removeChild(list.lastElementChild);
                }
                if (daysinmonth == 31 && document.getElementById("day").length == "31") {
                    document.getElementById("day").options.add(new Option("31", "31"));
                }
                if (daysinmonth == 31 && document.getElementById("day").length == "30") {
                    document.getElementById("day").options.add(new Option("30", "30"));
                    document.getElementById("day").options.add(new Option("31", "31"));
                }
                if (daysinmonth == 31 && document.getElementById("day").length == "29") {
                    document.getElementById("day").options.add(new Option("29", "29"));
                    document.getElementById("day").options.add(new Option("30", "30"));
                    document.getElementById("day").options.add(new Option("31", "31"));
                }
                if (daysinmonth == 30 && document.getElementById("day").length == "30") {
                    document.getElementById("day").options.add(new Option("30", "30"));
                }
                if (daysinmonth == 30 && document.getElementById("day").length == "29") {
                    document.getElementById("day").options.add(new Option("29", "29"));
                    document.getElementById("day").options.add(new Option("30", "30"));
                }
                if (daysinmonth == 29 && document.getElementById("day").length == "29") {
                    document.getElementById("day").options.add(new Option("29", "29"));
                }
            }
            function checkInput() {
                if (document.getElementById("day").value == "") {
                    document.getElementById("day").focus();
                    return false;
                } else if (document.getElementById("store").value == "") {
                    document.getElementById("store").focus();
                    return false;
                } else if (document.getElementById("AgentName").value == "") {
                    document.getElementById("AgentName").focus();
                    return false;
                } else if (document.getElementById("CSTName").value == "") {
                    document.getElementById("CSTName").focus();
                    return false;
                } else if (document.getElementById("Address").value == "") {
                    document.getElementById("Address").focus();
                    return false;
                } else if (document.getElementById("CSTId").value == "") {
                    document.getElementById("CSTId").focus();
                    return false;
                } else if (document.getElementById("ContactNumber").value == "") {
                    document.getElementById("ContactNumber").focus();
                    return false;
                } else if (document.getElementById("Central").value == "") {
                    document.getElementById("Central").focus();
                    return false;
                } else if (document.getElementById("Serial").value == "") {
                    document.getElementById("Serial").focus();
                    return false;
                } else if (document.getElementById("status").value == "") {
                    document.getElementById("status").focus();
                    return false;
                } else {
                    document.getElementById("submit").click();
                }
            }
            document.getElementById("FixedRequest").onkeypress = function (e) {
                var key = e.charCode || e.keyCode || 0;
                if (key == 13) {
                    e.preventDefault();
                }
            };
            const ScriptURL = "https://script.google.com/macros/s/AKfycbzAf2O4ZvN3bP3vOMwIBONqJuciQ62wVuIVfodv--az2nK0-Tz92GssAesr03Va7G7Xzw/exec?sheetName=Fixed-Requests-Sohag";
            const requestForm = document.forms["FixedRequest"];
            requestForm.addEventListener("submit", (e) => {
                document.getElementById("checkandsubmit").disabled = true;
                document.getElementById("checkandsubmit").innerHTML = "Sending";
                e.preventDefault();
                document.getElementById("RequestDate").value = document.getElementById("day").value + "/" + document.getElementById("month").value + "/" + document.getElementById("year").value;
                fetch(ScriptURL, { method: "POST", body: new FormData(FixedRequest) })
                    .then((response) => {
                        Sent();
                    })
                    .catch((error) => (document.getElementById("checkandsubmit").innerHTML = "Error!"));
            });
            function Sent() {
                document.getElementById("checkandsubmit").innerHTML = "Sent";
                another.style.display = "block";
            }
            function Another() {
                another.style.display = "none";
                document.getElementById("checkandsubmit").disabled = false;
                document.getElementById("day").value = "";
                document.getElementById("AgentName").value = "";
                document.getElementById("CSTName").value = "";
                document.getElementById("Address").value = "";
                document.getElementById("CSTId").value = "";
                document.getElementById("ContactNumber").value = "";
                document.getElementById("Central").value = "";
                document.getElementById("Serial").value = "";
                document.getElementById("status").value = "";
            }
        </script>
        <br />
        <footer>
            <p class="footer">Developed by: Mamdouh Khalaf .. "MUE Team"</p>
        </footer>
    </body>
</html>
